<Window x:Class="sadnerd.io.ATAS.MockChartApp.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:skia="clr-namespace:SkiaSharp.Views.WPF;assembly=SkiaSharp.Views.WPF"
        Title="KeyLevels Indicator Test Chart" 
        Height="800" Width="1400"
        Background="#1a1a2e"
        WindowStartupLocation="CenterScreen">

    <Window.Resources>
        <Style TargetType="Label">
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="FontSize" Value="12"/>
        </Style>
        <Style TargetType="Slider">
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="Width" Value="120"/>
        </Style>
        <Style TargetType="Button">
            <Setter Property="Background" Value="#3a3a5c"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderBrush" Value="#5a5a8c"/>
            <Setter Property="Padding" Value="8,4"/>
            <Setter Property="Margin" Value="3"/>
        </Style>
        <Style TargetType="CheckBox">
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="Margin" Value="5,2"/>
        </Style>
    </Window.Resources>

    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*"/>
            <ColumnDefinition Width="Auto"/>
        </Grid.ColumnDefinitions>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Top Control Bar -->
        <Border Grid.Row="0" Grid.ColumnSpan="2" Background="#2a2a4e" Padding="8">
            <StackPanel Orientation="Horizontal">
                <Label Content="Bar Width:" VerticalAlignment="Center"/>
                <Slider x:Name="BarWidthSlider" Minimum="2" Maximum="30" Value="8" 
                        VerticalAlignment="Center"
                        ValueChanged="BarWidthSlider_ValueChanged"/>
                <Label x:Name="BarWidthLabel" Content="8" Width="25" VerticalAlignment="Center"/>

                <Label Content="Y Scale:" VerticalAlignment="Center" Margin="15,0,0,0"/>
                <Slider x:Name="YScaleSlider" Minimum="0.1" Maximum="3" Value="1" 
                        VerticalAlignment="Center"
                        ValueChanged="YScaleSlider_ValueChanged"/>
                <Label x:Name="YScaleLabel" Content="1.0x" Width="35" VerticalAlignment="Center"/>

                <Button Content="Reset View" Click="ResetView_Click" Margin="15,0,0,0"/>
                <Button Content="Auto Fit" Click="AutoFit_Click"/>

                <Label Content="Pan:" VerticalAlignment="Center" Margin="15,0,0,0"/>
                <Button Content="â—„" Click="PanLeft_Click" Padding="5,2"/>
                <Button Content="â–º" Click="PanRight_Click" Padding="5,2"/>
                
                <Button Content="âš™ Settings" Click="ToggleSettings_Click" Margin="15,0,0,0"/>
            </StackPanel>
        </Border>

        <!-- Chart Canvas -->
        <skia:SKElement x:Name="ChartCanvas" Grid.Row="1" Grid.Column="0"
                        PaintSurface="ChartCanvas_PaintSurface"
                        MouseWheel="ChartCanvas_MouseWheel"
                        MouseLeftButtonDown="ChartCanvas_MouseLeftButtonDown"
                        MouseLeftButtonUp="ChartCanvas_MouseLeftButtonUp"
                        MouseMove="ChartCanvas_MouseMove"/>

        <!-- Settings Panel (Right Side) -->
        <Border x:Name="SettingsPanel" Grid.Row="1" Grid.Column="1" 
                Background="#2a2a4e" Width="220" Visibility="Collapsed">
            <ScrollViewer VerticalScrollBarVisibility="Auto">
                <StackPanel Margin="10">
                    <TextBlock Text="Indicator Settings" FontWeight="Bold" Foreground="White" 
                               FontSize="14" Margin="0,0,0,10"/>
                    
                    <!-- Multi-Chart Mode -->
                    <Button x:Name="MultiChartBtn" Content="ðŸ“Š Open Multi-Chart" Click="OpenMultiChart_Click" 
                            Margin="0,0,0,10" HorizontalAlignment="Stretch"/>
                    
                    <!-- Active Indicators -->
                    <TextBlock Text="Active Indicators" Foreground="#66BB6A" Margin="0,5,0,5"/>
                    <CheckBox x:Name="KeyLevelsCheck" Content="Key Levels" IsChecked="True" 
                              Click="IndicatorToggle_Click" Tag="Key Levels"/>
                    <CheckBox x:Name="PvsraCandlesCheck" Content="PVSRA Candles" IsChecked="False" 
                              Click="IndicatorToggle_Click" Tag="PVSRA Candles"/>
                    <CheckBox x:Name="EmaCloudCheck" Content="EMA with Cloud" IsChecked="False" 
                              Click="IndicatorToggle_Click" Tag="EMA with Cloud"/>
                    
                    <!-- Drawing Settings -->
                    <TextBlock Text="Drawing" Foreground="#aaa" Margin="0,5,0,5"/>
                    
                    <StackPanel Orientation="Horizontal" Margin="0,2">
                        <Label Content="Font Size:" Width="85"/>
                        <Slider x:Name="FontSizeSlider" Minimum="6" Maximum="18" Value="10" 
                                Width="80" ValueChanged="Setting_Changed"/>
                        <Label x:Name="FontSizeLabel" Content="10" Width="25"/>
                    </StackPanel>
                    
                    <StackPanel Orientation="Horizontal" Margin="0,2">
                        <Label Content="Line Width:" Width="85"/>
                        <Slider x:Name="LineWidthSlider" Minimum="20" Maximum="100" Value="50" 
                                Width="80" ValueChanged="Setting_Changed"/>
                        <Label x:Name="LineWidthLabel" Content="50" Width="25"/>
                    </StackPanel>
                    
                    <StackPanel Orientation="Horizontal" Margin="0,2">
                        <Label Content="BG Width:" Width="85"/>
                        <Slider x:Name="BGWidthSlider" Minimum="80" Maximum="300" Value="150" 
                                Width="80" ValueChanged="Setting_Changed"/>
                        <Label x:Name="BGWidthLabel" Content="150" Width="30"/>
                    </StackPanel>
                    
                    <CheckBox x:Name="ShortLabelsCheck" Content="Short Labels" IsChecked="True" 
                              Click="Setting_Changed"/>
                    
                    <!-- 4H Levels -->
                    <TextBlock Text="4H Levels" Foreground="#FFC107" Margin="0,10,0,5"/>
                    <CheckBox x:Name="Show4hOpenCheck" Content="4H Open" IsChecked="True" Click="Setting_Changed"/>
                    <CheckBox x:Name="Show4hHighLowCheck" Content="4H High/Low" IsChecked="True" Click="Setting_Changed"/>
                    <CheckBox x:Name="Show4hMidCheck" Content="4H Mid" IsChecked="True" Click="Setting_Changed"/>
                    
                    <!-- Daily Levels -->
                    <TextBlock Text="Daily Levels" Foreground="#2196F3" Margin="0,10,0,5"/>
                    <CheckBox x:Name="ShowDailyOpenCheck" Content="Day Open" IsChecked="True" Click="Setting_Changed"/>
                    <CheckBox x:Name="ShowPrevDayHLCheck" Content="Prev Day H/L" IsChecked="True" Click="Setting_Changed"/>
                    <CheckBox x:Name="ShowPrevDayMidCheck" Content="Prev Day Mid" IsChecked="True" Click="Setting_Changed"/>
                    
                    <!-- Monday Levels -->
                    <TextBlock Text="Monday Levels" Foreground="#9C27B0" Margin="0,10,0,5"/>
                    <CheckBox x:Name="ShowMondayHLCheck" Content="Monday H/L" IsChecked="True" Click="Setting_Changed"/>
                    <CheckBox x:Name="ShowMondayMidCheck" Content="Monday Mid" IsChecked="True" Click="Setting_Changed"/>
                    
                    <!-- Quarterly Levels -->
                    <TextBlock Text="Quarterly Levels" Foreground="#4CAF50" Margin="0,10,0,5"/>
                    <CheckBox x:Name="ShowQuarterlyOpenCheck" Content="Quarter Open" IsChecked="True" Click="Setting_Changed"/>
                    <CheckBox x:Name="ShowPrevQuarterHLCheck" Content="Prev Quarter H/L" IsChecked="True" Click="Setting_Changed"/>
                    <CheckBox x:Name="ShowPrevQuarterMidCheck" Content="Prev Quarter Mid" IsChecked="True" Click="Setting_Changed"/>
                    
                    <!-- Apply Button -->
                    <Button Content="Apply Settings" Click="ApplySettings_Click" Margin="0,15,0,0"
                            HorizontalAlignment="Stretch"/>
                </StackPanel>
            </ScrollViewer>
        </Border>

        <!-- Bottom Status Bar -->
        <Border Grid.Row="2" Grid.ColumnSpan="2" Background="#2a2a4e" Padding="10">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <StackPanel Grid.Column="0" Orientation="Horizontal">
                    <Label Content="Visible Bars:"/>
                    <Label x:Name="VisibleBarsLabel" Content="0 - 0"/>
                    <Label Content="Price Range:" Margin="20,0,0,0"/>
                    <Label x:Name="PriceRangeLabel" Content="0 - 0"/>
                </StackPanel>

                <StackPanel Grid.Column="2" Orientation="Horizontal">
                    <Label Content="Mouse:"/>
                    <Label x:Name="MouseInfoLabel" Content="---"/>
                </StackPanel>
            </Grid>
        </Border>
    </Grid>
</Window>
